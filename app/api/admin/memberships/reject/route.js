import { NextResponse } from 'next/server'; import { supabaseAdmin } from '../../../../../lib/supabaseAdmin'; import { requireAdmin } from '../../../../../lib/adminAuth'
export async function POST(req){ try{ requireAdmin() }catch{ return NextResponse.json({error:'Unauthorized'},{status:401}) } const { membership_id, reason } = await req.json(); const admin=supabaseAdmin(); const { error }=await admin.from('memberships').update({ status:'rejected', motivation: reason || null, reviewed_at: new Date().toISOString() }).eq('id', membership_id); if(error) return NextResponse.json({error:error.message},{status:400}); return NextResponse.json({ok:true}) }
