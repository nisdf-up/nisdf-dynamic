import { NextResponse } from 'next/server'; import { supabaseAdmin } from '../../../../lib/supabaseAdmin'; import { requireAdmin } from '../../../../lib/adminAuth'
export async function GET(req){ try{ requireAdmin() }catch{ return NextResponse.json({error:'Unauthorized'},{status:401}) } const { searchParams }=new URL(req.url); const status=searchParams.get('status')||'pending'; const admin=supabaseAdmin(); const { data, error }=await admin.from('memberships').select('*').eq('status',status).order('created_at',{ascending:true}); if(error) return NextResponse.json({error:error.message},{status:400}); return NextResponse.json({items:data||[]}) }
